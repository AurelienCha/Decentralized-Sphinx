\section{Introduction}

Mix network, or mixnet, is an overlay network of servers (called mix nodes) that routes messages anonymously from senders
to receivers~\cite{chaum-mix,cypherpunk-remailer,piotrowska2017loopix,nym-network-whitepaper,minion-design, van2015vuvuzela,mixmaster-spec,chaum2016cmix}. Although mixnet shares similarities with Tor~\cite{onion-routing96}, they differ in two main key aspects: (i) the routing in Tor is circuit-based (meaning that all packets sent by a user follow the same path for the entire session) and in mixnets is packet-based (meaning that each packet follows a different path) and (ii) packets in Tor are forwarded immediately upon receipt by the Tor nodes while in mixnets packets are delayed for a certain amount of time $t$ in order to mitigate timing analysis attacks. These two techniques ensure that mixnets are resilient against a strong adversary who observes the entire input and outputs of the network typically called a Global Passive Adversary (GPA).
Based on Loopix~\cite{piotrowska2017loopix}, Nym Technologies is a mixnet-based system that allow users to send traffic anonymously.
Nym is a paid service where services can be integrated on the Nym network to enjoy privacy on the network level against a fee. Users of these services are then allowed to use the nym mixnet by using Nym credentials (based on the Coconut credential~\cite{coconut}) that they can construct after getting a certificate of paying a specefic service to use the nym network. 



However, nothing prevents users from cheating who might exploit a valid Nym credential to for another service they did not pay for. This is a particular difficult problem in anonymous communication networks where the mixnodes do not know the traffic type or the final service a user is communicating with by doing layered encryption where the final IP address is only know by the last node in the path using a packer format such as Sphinx~\cite{sphinx}. 
\newline
In this paper we present a scheme that creates the Sphinx header in a decentralized way based on trusted third parties while ensuring they learn nothing about the destination or the path. We aim to provide the following properties:
\begin{itemize}
	\item Cheating users: Users's traffic is only allowed to be routed if the traffic belongs to the same service provider from the credential
	\item even if the majority of headers issuers are colluding, they do not know whcih service provider the user is communicating with.
	\item the spinx headers can not be altered.
	\item Verifiers can verify that the headers has not been altered without revealing the service provider.
	\item Unlinkability between  sphinx packets, the original sphinx packet that is constructed in a centralized way provide the \textit{unlinkability} property, meaning that an adversary can not know that two packets are connected to the same user. Our scheme that decentralize the headers creation aim at providing this same property.
\end{itemize}
We highlight related work and motivation in Section~\ref{sec:related}, then we specify and justify our system model in Section~\cite{sec:sys_model}, where we also describe the considered threat model. We then present our scheme that decentralize the creation of the Sphinx headers in Section~\cite{sec:scheme} and the evaluation of our proposed solution in Section~\cite{sec:eval}. Finally we conclude and discuss future work in Section~\cite{sec:conclusion}